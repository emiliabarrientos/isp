# h2.4 (q0064_0004) - triste  -------
ISP$h2.4 <- as.factor(ISP$q0064_0004)
ISP$h2.4 <- car::recode(ISP$h2.4, recodes= c("1='Nunca';2='Solo unas pocas veces';3='Algunas veces';4='La mayoria de las veces';5='Siempre';NA=NA"), as.factor = T,
levels= c("Nunca", "Solo unas pocas veces", "Algunas veces", "La mayoria de las veces", "Siempre"))
# h2.5 (q0064_0005) - feliz  -------
ISP$h2.5 <- as.factor(ISP$q0064_0005)
ISP$h2.5 <- car::recode(ISP$h2.5, recodes= c("1='Nunca';2='Solo unas pocas veces';3='Algunas veces';4='La mayoria de las veces';5='Siempre';NA=NA"), as.factor = T,
levels= c("Nunca", "Solo unas pocas veces", "Algunas veces", "La mayoria de las veces", "Siempre"))
# H.3 (q0064_0006 a q0064_0008) - Salud Física  ---------
# h3.1 (q0063_0006) - dolor  -------
ISP$h3.1 <- as.factor(ISP$q0065_0001)
ISP$h3.1 <- car::recode(ISP$h3.1, recodes= c("1='Nunca';2='Solo unas pocas veces';3='Algunas veces';4='La mayoria de las veces';5='Siempre';NA=NA"), as.factor = T,
levels= c("Nunca", "Solo unas pocas veces", "Algunas veces", "La mayoria de las veces", "Siempre"))
table(ISP$h3.1)
# h3.2 (q0063_0007) - percepcion dolor  -------
ISP$h3.2 <- as.factor(ISP$q0065_0002)
ISP$h3.2 <- car::recode(ISP$h3.2, recodes= c("1='Nunca';2='Solo unas pocas veces';3='Algunas veces';4='La mayoria de las veces';5='Siempre';NA=NA"), as.factor = T,
levels= c("Nunca", "Solo unas pocas veces", "Algunas veces", "La mayoria de las veces", "Siempre"))
# h3.3 (q0063_0008) - palpitaciones  -------
ISP$h3.3 <- as.factor(ISP$q0065_0003)
ISP$h3.3 <- car::recode(ISP$h3.3, recodes= c("1='Nunca';2='Solo unas pocas veces';3='Algunas veces';4='La mayoria de las veces';5='Siempre';NA=NA"), as.factor = T,
levels= c("Nunca", "Solo unas pocas veces", "Algunas veces", "La mayoria de las veces", "Siempre"))
table(ISP$h3.3)
## I. Tareas teletrabajbles (ámbos modulos)
# i.1 (q0066) - Tareas que cree se podrían teletrabajar ---------
# i1.1 (q0066_0001) - reuniones -------
table(ISP$q0066_0001)
ISP$i1.1 <- as.factor(ISP$q0066_0001)
ISP$i1.1 <- car::recode(ISP$i1.1, recodes= c("1='Si';NA='No'"), as.factor = T,
levels= c("Si", "No"))
levels(ISP$i1.1)
table(ISP$i1.1)
# i1.2 (q0066_0002) - atencion  -------
ISP$i1.2 <- as.factor(ISP$q0066_0002)
ISP$i1.2 <- car::recode(ISP$i1.2, recodes= c("1='Si';NA='No'"), as.factor = T,
levels= c("Si", "No"))
# i1.3 (q0066_0003) - informacion  -------
ISP$i1.3 <- as.factor(ISP$q0066_0003)
ISP$i1.3 <- car::recode(ISP$i1.3, recodes= c("1='Si';NA='No'"), as.factor = T,
levels= c("Si", "No"))
# i1.4 (q0066_0004) - tareas simples  sin concentracion -------
ISP$i1.4 <- as.factor(ISP$q0066_0004)
ISP$i1.4 <- car::recode(ISP$i1.4, recodes= c("1='Si';NA='No'"), as.factor = T,
levels= c("Si", "No"))
# i1.5 (q0066_0005) - tareas simples concentracion  -------
ISP$i1.5 <- as.factor(ISP$q0066_0005)
ISP$i1.5 <- car::recode(ISP$i1.5, recodes= c("1='Si';NA='No'"), as.factor = T,
levels= c("Si", "No"))
# i1.6 (q0066_0006) - tareas complejas concentracion  -------
table(ISP$q0066_0006)
ISP$i1.6 <- as.factor(ISP$q0066_0006)
ISP$i1.6 <- car::recode(ISP$i1.6, recodes= c("1='Si';NA='No'"), as.factor = T,
levels= c("Si", "No"))
table(ISP$i1.6)
## i3 -------------
#i3.1 ----
table(ISP$q0067_0001)
ISP$i3.1 <- as.factor(ISP$q0067_0001)
ISP$i3.1 <- car::recode(ISP$i3.1, recodes = c("1='Muy en desacuerdo';2='En desacuerdo'; 3='Ni acuerdo ni desacuerdo'; 4= 'De acuerdo'; 5='Muy de acuerdo'"), as.factor = T,
levels =  c("Muy en desacuerdo", "En desacuerdo", "Ni acuerdo ni desacuerdo", "De acuerdo", "Muy de acuerdo"))
#i3.2 ----
table(ISP$q0067_0002)
ISP$i3.2 <- as.factor(ISP$q0067_0002)
ISP$i3.2 <- car::recode(ISP$i3.2, recodes = c("1='Muy en desacuerdo';2='En desacuerdo'; 3='Ni acuerdo ni desacuerdo'; 4= 'De acuerdo'; 5='Muy de acuerdo'"), as.factor = T,
levels =  c("Muy en desacuerdo", "En desacuerdo", "Ni acuerdo ni desacuerdo", "De acuerdo", "Muy de acuerdo"))
#i3.3 ----
table(ISP$q0067_0003)
ISP$i3.3 <- as.factor(ISP$q0067_0003)
ISP$i3.3 <- car::recode(ISP$i3.3, recodes = c("1='Muy en desacuerdo';2='En desacuerdo'; 3='Ni acuerdo ni desacuerdo'; 4= 'De acuerdo'; 5='Muy de acuerdo'"), as.factor = T,
levels =  c("Muy en desacuerdo", "En desacuerdo", "Ni acuerdo ni desacuerdo", "De acuerdo", "Muy de acuerdo"))
#i3.4 ----
table(ISP$q0067_0004)
ISP$i3.4 <- as.factor(ISP$q0067_0004)
ISP$i3.4 <- car::recode(ISP$i3.4, recodes = c("1='Muy en desacuerdo';2='En desacuerdo'; 3='Ni acuerdo ni desacuerdo'; 4= 'De acuerdo'; 5='Muy de acuerdo'"), as.factor = T,
levels =  c("Muy en desacuerdo", "En desacuerdo", "Ni acuerdo ni desacuerdo", "De acuerdo", "Muy de acuerdo"))
#i3.5 ----
table(ISP$q0067_0005)
ISP$i3.5 <- as.factor(ISP$q0067_0005)
ISP$i3.5 <- car::recode(ISP$i3.5, recodes = c("1='Muy en desacuerdo';2='En desacuerdo'; 3='Ni acuerdo ni desacuerdo'; 4= 'De acuerdo'; 5='Muy de acuerdo'"), as.factor = T,
levels =  c("Muy en desacuerdo", "En desacuerdo", "Ni acuerdo ni desacuerdo", "De acuerdo", "Muy de acuerdo"))
#i3.6 ----
table(ISP$q0067_0006)
ISP$i3.6 <- as.factor(ISP$q0067_0006)
ISP$i3.6 <- car::recode(ISP$i3.6, recodes = c("1='Muy en desacuerdo';2='En desacuerdo'; 3='Ni acuerdo ni desacuerdo'; 4= 'De acuerdo'; 5='Muy de acuerdo'"), as.factor = T,
levels =  c("Muy en desacuerdo", "En desacuerdo", "Ni acuerdo ni desacuerdo", "De acuerdo", "Muy de acuerdo"))
table(ISP$i3.6)
# i2 (q0084) - Nuevas modalidades preferidas  ---------
table(ISP$q0068)
ISP$i2 <- as.factor(ISP$q0068)
ISP$i2 <- car::recode(ISP$i2, recodes= c("1='Teletrabajo total';2='Teletrabajo parcial';3='Trabajo normal';NA=NA"), as.factor = T,
levels= c("Teletrabajo total", "Teletrabajo parcial", "Trabajo normal"))
# Z. Correo de contacto
ISP$mail <- ISP$q0069
write.csv(ISP$mail, file = "data/isp-email.csv")
write.csv(ISP$mail, file = "informe_resultados/data/isp-email.csv")
## 4. Seleccionar variables
ISP_proc <- ISP %>% select(- starts_with(c("q","p")))
View(ISP_proc)
save(ISP_proc, file = "informe_resultados/data/ISP_proc.RData")
write.csv(ISP_proc, file = "informe_resultados/data/ISP_proc.csv")
22000/60
366.6667*53
366.6667*48
12+9
60-19
366.6667*50
366.6667*33
data_isp_rc <- readRDS("C:/Users/catac/Dropbox/Cata/Github/isp/informe_resultados/data/data_isp.rds")
mergesvy <- data_isp_rc %>%
as_survey_design(
weights = pond1)
library(dplyr)
library(car)
library(summarytools)
library(ggplot2)
library(magrittr)
library(tidyverse)
library(writexl)
library(tibble)
library(readr)
library(survey)
library(srvyr)
data_isp_rc <- readRDS("C:/Users/catac/Dropbox/Cata/Github/isp/informe_resultados/data/data_isp.rds")
mergesvy <- data_isp_rc %>%
as_survey_design(
weights = pond1)
table_freq_01 <- mergesvy %>%
dplyr::group_by(a1_sexo) %>%
summarize(proportion = survey_mean(,na.rm=TRUE))
df=data.frame(table_freq_01, digits=2)
df= df %>%
mutate(perc = proportion * 100) %>%
mutate(p=round(perc, 2)) %>%
rename(género=a1_sexo)
df %>%
ggplot(aes(x=género, y=proportion))+
geom_bar(stat="identity", position = position_dodge())+
geom_text(aes(label = p), position = position_dodge(0.8), vjust=0, hjust = -0.1, size = 3, angle =90)+
scale_y_continuous(limits = c(0, 1), labels = scales::percent)
df %>%
ggplot(aes(x=género, y=proportion))+
geom_bar(stat="identity", position = position_dodge())+
geom_text(aes(label = p), position = position_dodge(0.8), vjust=0, hjust = -0.1, size = 3, angle =90)+
scale_y_continuous(limits = c(0, 1), labels = scales::percent)+
labs(x = "Response", y = "%")
df %>%
ggplot(aes(x=género, y=proportion))+
geom_bar(stat="identity", position = position_dodge())+
geom_text(aes(label = p), position = position_dodge(0.8), vjust=0, hjust = -0.1, size = 3, angle =90)+
scale_y_continuous(limits = c(0, 8), labels = scales::percent)+
labs(x = "Response", y = "%")
df %>%
ggplot(aes(x=género, y=proportion))+
geom_bar(stat="identity", position = position_dodge())+
geom_text(aes(label = p), position = position_dodge(0.8), vjust=0, hjust = -0.1, size = 3, angle =90)+
scale_y_continuous(limits = c(0, 0.8), labels = scales::percent)+
labs(x = "Response", y = "%")
df
df= df %>%
mutate(perc = proportion * 100) %>%
mutate(p=round(perc, 2)) %>%
rename(género=a1_sexo) %>%
mutate(origen="ISP")
table_freq_01 <- mergesvy %>%
dplyr::group_by(a1_sexo) %>%
summarize(proportion = survey_mean(,na.rm=TRUE))
df=data.frame(table_freq_01, digits=2)
df= df %>%
mutate(perc = proportion * 100) %>%
mutate(p=round(perc, 2)) %>%
rename(género=a1_sexo) %>%
mutate(origen="ISP")
df
df= df %>%
mutate(perc = proportion * 100) %>%
mutate(p=round(perc, 2)) %>%
rename(género=a1_sexo) %>%
mutate(origen="ISP") %>%
select(género, p, origen)
df=data.frame(table_freq_01, digits=2)
df= df %>%
mutate(perc = proportion * 100) %>%
mutate(p=round(perc, 2)) %>%
rename(género=a1_sexo) %>%
mutate(origen="ISP") %>%
select(género, p, origen)
df
OIT_pod <- read_excel("C:/Users/catac/Dropbox/Cata/Pegas/Nodo XXI/OIT_pod.xlsx")
library(readxl)
OIT_pod <- read_excel("C:/Users/catac/Dropbox/Cata/Pegas/Nodo XXI/OIT_pod.xlsx")
View(OIT_pod)
OIT_pod <- read_excel("C:/Users/catac/Dropbox/Cata/Pegas/Nodo XXI/OIT_pod.xlsx")
View(table_freq_01)
View(OIT_pod)
df_1=data.frame(OIT_pod)
df_1
df
df_1=data.frame(OIT_pod, digits=2)
df_1
OIT_pod <- read_excel("C:/Users/catac/Dropbox/Cata/Pegas/Nodo XXI/OIT_pod.xlsx")
mergesvy <- data_isp_rc %>%
as_survey_design(
weights = pond1)
table_freq_01 <- mergesvy %>%
dplyr::group_by(a1_sexo) %>%
summarize(proportion = survey_mean(,na.rm=TRUE))
df=data.frame(table_freq_01, digits=2)
df_1=data.frame(OIT_pod, digits=2)
df_1
df
df= df %>%
mutate(perc = proportion * 100) %>%
mutate(p=round(perc, 2)) %>%
rename(género=a1_sexo) %>%
mutate(origen="ISP") %>%
select(género, p, origen)
df
OIT_pod
OIT_pod <- read_excel("C:/Users/catac/Dropbox/Cata/Pegas/Nodo XXI/OIT_pod.xlsx")
mergesvy <- data_isp_rc %>%
as_survey_design(
weights = pond1)
table_freq_01 <- mergesvy %>%
dplyr::group_by(a1_sexo) %>%
summarize(proportion = survey_mean(,na.rm=TRUE))
df=data.frame(table_freq_01, digits=2)
df_1=data.frame(OIT_pod, digits=2)
df= df %>%
mutate(perc = proportion * 100) %>%
mutate(p=round(perc, 2)) %>%
rename(género=a1_sexo) %>%
mutate(origen="ISP") %>%
select(género, p, origen)
df
df_1
df_compare <- rbind(df, df_1)
df=data.frame(table_freq_01)
df= df %>%
mutate(perc = proportion * 100) %>%
mutate(p=round(perc, 2)) %>%
rename(género=a1_sexo) %>%
mutate(origen="ISP") %>%
select(género, p, origen)
df_1=data.frame(OIT_pod, digits=2)
df_compare <- rbind(df, df_1)
df_1
df_1=data.frame(OIT_pod)
df_compare <- rbind(df, df_1)
df_compare
df %>%
ggplot(aes(x=género, y=proportion))+
geom_bar(stat="identity", position = position_dodge())+
geom_text(aes(label = p), position = position_dodge(0.8), vjust=0, hjust = -0.1, size = 3, angle =90)+
facet_wrap(~origen, scales = "free_x")+
scale_y_continuous(limits = c(0, 0.8), labels = scales::percent)+
labs(x = "Response", y = "%")
df %>%
ggplot(aes(x=género, y=p))+
geom_bar(stat="identity", position = position_dodge())+
geom_text(aes(label = p), position = position_dodge(0.8), vjust=0, hjust = -0.1, size = 3, angle =90)+
facet_wrap(~origen, scales = "free_x")+
scale_y_continuous(limits = c(0, 0.8), labels = scales::percent)+
labs(x = "Response", y = "%")
#Pais
mergesvy <- data_isp_rc %>%
as_survey_design(
weights = pond1)
table_freq_01 <- mergesvy %>%
dplyr::group_by(a0_pais) %>%
summarize(proportion = survey_mean(,na.rm=TRUE))
df=data.frame(table_freq_01)
df= df %>%
mutate(perc = proportion * 100) %>%
mutate(p=round(perc, 2)) %>%
rename(país=a0_pais) %>%
df_1=data.frame(OIT_pod)
df= df %>%
mutate(perc = proportion * 100) %>%
mutate(p=round(perc, 2)) %>%
rename(país=a0_pais)
df %>%
ggplot(aes(x=país, y=p))+
geom_bar(stat="identity", position = position_dodge())+
geom_text(aes(label = p), position = position_dodge(0.8), vjust=0, hjust = -0.1, size = 3, angle =90)+
scale_y_continuous(limits = c(0, 0.8), labels = scales::percent)+
labs(x = "Response", y = "%")
df %>%
ggplot(aes(x=país, y=proportion))+
geom_bar(stat="identity", position = position_dodge())+
geom_text(aes(label = p), position = position_dodge(0.8), vjust=0, hjust = -0.1, size = 3, angle =90)+
scale_y_continuous(limits = c(0, 0.8), labels = scales::percent)+
labs(x = "Response", y = "%")
df %>%
ggplot(aes(x=país, y=proportion))+
geom_bar(stat="identity", position = position_dodge())+
geom_text(aes(label = p), position = position_dodge(0.8), vjust=0, hjust = -0.1, size = 3, angle =90)+
scale_y_continuous(limits = c(0, 0.8), labels = scales::percent)+
labs(x = "País", y = "%")
df
df %>%
ggplot(aes(x=país, y=proportion))+
geom_bar(stat="identity", position = position_dodge())+
geom_text(aes(label = p), position = position_dodge(0.8), vjust=0, hjust = -0.1, size = 3, angle =90)+
scale_y_continuous(limits = c(0, 0.5), labels = scales::percent)+
labs(x = "País", y = "%")
OIT_pod <- read_excel("C:/Users/catac/Dropbox/Cata/Pegas/Nodo XXI/OIT_pod.xlsx")
mergesvy <- data_isp_rc %>%
as_survey_design(
weights = pond1)
table_freq_01 <- mergesvy %>%
dplyr::group_by(a1_sexo) %>%
summarize(proportion = survey_mean(,na.rm=TRUE))
df=data.frame(table_freq_01)
df= df %>%
mutate(perc = proportion * 100) %>%
mutate(p=round(perc, 2)) %>%
rename(género=a1_sexo) %>%
mutate(origen="ISP") %>%
select(género, proportion, origen)
df_1=data.frame(OIT_pod)
df_compare <- rbind(df, df_1)
df %>%
ggplot(aes(x=género, y=proportion))+
geom_bar(stat="identity", position = position_dodge())+
geom_text(aes(label = p), position = position_dodge(0.8), vjust=0, hjust = -0.1, size = 3, angle =90)+
facet_wrap(~origen, scales = "free_x")+
scale_y_continuous(limits = c(0, 0.8), labels = scales::percent)+
labs(x = "Response", y = "%")
df_compare
OIT_pod <- read_excel("C:/Users/catac/Dropbox/Cata/Pegas/Nodo XXI/OIT_pod.xlsx")
mergesvy <- data_isp_rc %>%
as_survey_design(
weights = pond1)
table_freq_01 <- mergesvy %>%
dplyr::group_by(a1_sexo) %>%
summarize(proportion = survey_mean(,na.rm=TRUE))
#help(srvyr)
df=data.frame(table_freq_01)
#summary(factor(df$proportion))
df= df %>%
mutate(perc = proportion * 100) %>%
mutate(p=round(perc, 2)) %>%
rename(género=a1_sexo) %>%
mutate(origen="ISP") %>%
select(género, proportion, origen, p)
df_1=data.frame(OIT_pod)
df_compare <- rbind(df, df_1)
df %>%
ggplot(aes(x=género, y=proportion))+
geom_bar(stat="identity", position = position_dodge())+
geom_text(aes(label = p), position = position_dodge(0.8), vjust=0, hjust = -0.1, size = 3, angle =90)+
facet_wrap(~origen, scales = "free_x")+
scale_y_continuous(limits = c(0, 0.8), labels = scales::percent)+
labs(x = "Response", y = "%")
df %>%
ggplot(aes(x=género, y=proportion))+
geom_bar(stat="identity", position = position_dodge())+
geom_text(aes(label = p), position = position_dodge(0.8), vjust=0, hjust = -0.1, size = 3, angle =90)+
facet_wrap(origen~género, scales = "free_x")+
scale_y_continuous(limits = c(0, 0.8), labels = scales::percent)+
labs(x = "Response", y = "%")
df_compare
table_freq_01 <- mergesvy %>%
filter(a1_sexo!="Otro") %>%
dplyr::group_by(a1_sexo) %>%
summarize(proportion = survey_mean(,na.rm=TRUE))
df=data.frame(table_freq_01)
df= df %>%
mutate(perc = proportion * 100) %>%
mutate(p=round(perc, 2)) %>%
rename(género=a1_sexo) %>%
mutate(origen="ISP") %>%
select(género, proportion, origen, p)
df_1=data.frame(OIT_pod)
df_compare <- rbind(df, df_1)
df %>%
ggplot(aes(x=género, y=proportion))+
geom_bar(stat="identity", position = position_dodge())+
geom_text(aes(label = p), position = position_dodge(0.8), vjust=0, hjust = -0.1, size = 3, angle =90)+
facet_wrap(origen~género, scales = "free_x")+
scale_y_continuous(limits = c(0, 0.8), labels = scales::percent)+
labs(x = "Response", y = "%")
df_compare
df %>%
ggplot(aes(x=género, y=proportion))+
geom_bar(stat="identity", position = position_dodge())+
geom_text(aes(label = p), position = position_dodge(0.8), vjust=0, hjust = -0.1, size = 3, angle =90)+
facet_wrap(origen, scales = "free_x")+
scale_y_continuous(limits = c(0, 0.8), labels = scales::percent)+
labs(x = "Response", y = "%")
df %>%
ggplot(aes(x=género, y=proportion))+
geom_bar(stat="identity", position = position_dodge())+
geom_text(aes(label = p), position = position_dodge(0.8), vjust=0, hjust = -0.1, size = 3, angle =90)+
facet_wrap(~origen, scales = "free_x")+
scale_y_continuous(limits = c(0, 0.8), labels = scales::percent)+
labs(x = "Response", y = "%")
df %>%
ggplot(aes(x=género, y=proportion))+
geom_bar(stat="identity", position = position_dodge())+
geom_text(aes(label = p), position = position_dodge(0.8), vjust=0, hjust = -0.1, size = 3, angle =90)+
facet_grid(~origen, scales = "free_x")+
scale_y_continuous(limits = c(0, 0.8), labels = scales::percent)+
labs(x = "Response", y = "%")
df %>%
ggplot(aes(x=género, y=proportion, fill=origen))+
geom_bar(stat="identity", position = position_dodge())+
geom_text(aes(label = p), position = position_dodge(0.8), vjust=0, hjust = -0.1, size = 3, angle =90)+
facet_grid(~origen, scales = "free_x")+
scale_y_continuous(limits = c(0, 0.8), labels = scales::percent)+
labs(x = "Response", y = "%")
df_compare %>%
ggplot(aes(x=género, y=proportion, fill=origen))+
geom_bar(stat="identity", position = position_dodge())+
geom_text(aes(label = p), position = position_dodge(0.8), vjust=0, hjust = -0.1, size = 3, angle =90)+
facet_grid(~origen, scales = "free_x")+
scale_y_continuous(limits = c(0, 0.8), labels = scales::percent)+
labs(x = "Response", y = "%")
#Pais
mergesvy <- data_isp_rc %>%
as_survey_design(
weights = pond1)
df_compare %>%
ggplot(aes(x=género, y=proportion, fill=origen))+
geom_bar(stat="identity", position = position_dodge())+
geom_text(aes(label = p), position = position_dodge(0.8), vjust=0, hjust = -0.1, size = 3, angle =90)+
facet_grid(~origen, scales = "free_x")+
scale_y_continuous(limits = c(0, 0.8), labels = scales::percent)+
scale_fill_manual(values = c("#d40c04","#d3d3d3"))+
labs(x = "Response", y = "%")
OIT_pod <- read_excel("C:/Users/catac/Dropbox/Cata/Pegas/Nodo XXI/OIT_pod.xlsx")
mergesvy <- data_isp_rc %>%
as_survey_design(
weights = pond1)
table_freq_01 <- mergesvy %>%
filter(a1_sexo!="Otro") %>%
dplyr::group_by(a1_sexo) %>%
summarize(proportion = survey_mean(,na.rm=TRUE))
#help(srvyr)
df=data.frame(table_freq_01)
#summary(factor(df$proportion))
df= df %>%
mutate(perc = proportion * 100) %>%
mutate(p=round(perc, 2)) %>%
rename(género=a1_sexo) %>%
mutate(Encuesta="ISP") %>%
select(género, proportion, origen, p)
df_1=data.frame(OIT_pod)
df_compare <- rbind(df, df_1)
df_compare %>%
ggplot(aes(x=género, y=proportion, fill=Encuesta))+
geom_bar(stat="identity", position = position_dodge())+
geom_text(aes(label = p), position = position_dodge(0.8), vjust=0, hjust = -0.1, size = 3, angle =90)+
facet_grid(~Encuesta, scales = "free_x")+
scale_y_continuous(limits = c(0, 0.8), labels = scales::percent)+
scale_fill_manual(values = c("#d40c04","#d3d3d3"))+
labs(x = "Response", y = "%")
OIT_pod <- read_excel("C:/Users/catac/Dropbox/Cata/Pegas/Nodo XXI/OIT_pod.xlsx")
mergesvy <- data_isp_rc %>%
as_survey_design(
weights = pond1)
table_freq_01 <- mergesvy %>%
filter(a1_sexo!="Otro") %>%
dplyr::group_by(a1_sexo) %>%
summarize(proportion = survey_mean(,na.rm=TRUE))
df=data.frame(table_freq_01)
df= df %>%
mutate(perc = proportion * 100) %>%
mutate(p=round(perc, 2)) %>%
rename(género=a1_sexo) %>%
mutate(encuesta="ISP") %>%
select(género, proportion, encuesta, p)
df_1=data.frame(OIT_pod)
df_compare <- rbind(df, df_1)
df_1
df= df %>%
mutate(perc = proportion * 100) %>%
mutate(p=round(perc, 2)) %>%
rename(género=a1_sexo) %>%
mutate(Encuesta="ISP") %>%
select(género, proportion, Encuesta, p)
table_freq_01 <- mergesvy %>%
filter(a1_sexo!="Otro") %>%
dplyr::group_by(a1_sexo) %>%
summarize(proportion = survey_mean(,na.rm=TRUE))
#help(srvyr)
df=data.frame(table_freq_01)
#summary(factor(df$proportion))
df= df %>%
mutate(perc = proportion * 100) %>%
mutate(p=round(perc, 2)) %>%
rename(género=a1_sexo) %>%
mutate(Encuesta="ISP") %>%
select(género, proportion, Encuesta, p)
df_1=data.frame(OIT_pod)
df_compare <- rbind(df, df_1)
df_compare %>%
ggplot(aes(x=género, y=proportion, fill=Encuesta))+
geom_bar(stat="identity", position = position_dodge())+
geom_text(aes(label = p), position = position_dodge(0.8), vjust=0, hjust = -0.1, size = 3, angle =90)+
facet_grid(~Encuesta, scales = "free_x")+
scale_y_continuous(limits = c(0, 0.8), labels = scales::percent)+
scale_fill_manual(values = c("#d40c04","#d3d3d3"))+
labs(x = "Response", y = "%")
df_compare %>%
ggplot(aes(x=género, y=proportion, fill=Encuesta))+
geom_bar(stat="identity", position = position_dodge())+
geom_text(aes(label = p), position = position_dodge(0.8), vjust=0, hjust = -0.1, size = 3, angle =90)+
facet_grid(~Encuesta, scales = "free_x")+
scale_y_continuous(limits = c(0, 0.8), labels = scales::percent)+
scale_fill_manual(values = c("#d40c04","#d3d3d3"))+
labs(x = "Género", y = "%")
